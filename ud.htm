<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>파일 업로드 및 다운로드</title>
</head>
<body>
    <h1>파일 업로드 및 다운로드</h1>

    <!-- 파일 업로드 폼 -->
    <form id="uploadForm" enctype="multipart/form-data" method="post" action="/upload">
        <input type="file" name="file" id="imageFileOpenInput">
        <button type="submit">파일 업로드</button>
    </form>

    <!-- 업로드 후 다운로드할 수 있는 링크를 보여줌 -->
    <div id="downloadLink" style="display: none;">
        <h2>업로드된 파일 다운로드</h2>
        <a id="fileDownloadLink" href="#" download>파일 다운로드</a>
    </div>

    <script>
        document.getElementById('uploadForm').onsubmit = function(event) {
            event.preventDefault();
            
            var formData = new FormData();
            var fileInput = document.getElementById('imageFileOpenInput');
            var file = fileInput.files[0];
            
            if (file) {
                formData.append('file', file);
                fetch('/upload', {
                    method: 'POST',
                    body: formData
                })
                .then(response => response.json())  // 서버에서 파일 경로를 반환한다고 가정
                .then(data => {
                    alert('파일 업로드 성공!');
                    var downloadLink = document.getElementById('downloadLink');
                    var fileDownloadLink = document.getElementById('fileDownloadLink');
                    fileDownloadLink.href = data.filePath;  // 서버에서 반환한 파일 경로를 사용
                    fileDownloadLink.download = file.name;
                    downloadLink.style.display = 'block';  // 다운로드 링크 표시
                })
                .catch(error => console.error('파일 업로드 실패:', error));
            } else {
                alert('파일을 선택하세요.');
            }
        };
    </script>
</body>
</html>
